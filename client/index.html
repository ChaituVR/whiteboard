<!doctype html>
<html>

<head>
  <title>White Board</title>
  <style>
    .client-cursor {
      width: 25px;
      height: 23px;
      position: absolute;
      margin: -2px;
      margin-left: -5px;
      z-index: 100;
    }

    .tooltiptext {
      width: auto;
      background-color: black;
      opacity: 0.1;
      color: #fff;
      text-align: center;
      padding: 5px 5px;
      border-radius: 6px;
      position: absolute;
      top: 19px;
      left: 17px;
      z-index: 100;
    }

    .tooltiptext:hover {
      opacity: 0.9;
    }
  </style>

<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<link rel="stylesheet" href="public/css/style.css">
</head>

<body>
  <h2>Draw Something Cool</h2>
 <div id="cursor">
 </div>
 <div id="settings">
   <div class="btn"><span class="icon icon-gear"></span></div>
   <div id="all-settings" class="hidden">
     <div class="draw-inputs">
       <label for="background-color">Background : </label><input id="background-color" name="background-color" type="color" value="#ffffff">
     </div>
     <div class="draw-inputs">
       <label for="brush-sizeinput">Size:</label>
       <input name="lineWidth" id="brush-sizeinput" type="range" step="2" max="50" min="3" value="20" />
     </div>

     <div class="draw-inputs">
       <label for="base">Brush Color : </label><input id="brush-color" name="base" type="color" value="#BADA55">
     </div>

     <div class="draw-inputs">
       <label for="base">HSL Color : </label><input id="brush-hsl" name="hsl" type="checkbox">
     </div>
      <div class="draw-inputs">
       <label for="operation-types">Effect : </label><select id="operation-types" name="operation-types"></select>
     </div>
      <div class="draw-inputs">
     <button id="download" name="download">Download as Image</button>
     </div>
   </div>
 </div>
 <canvas id="draw"></canvas>

  <script src="public/js/jquery.min.js"></script>
  <script src="public/js/index.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <script>
    var socket = io();
    socket.emit('adduser', prompt("What's your name?"));
    var oldUsers = [];
    $(document).ready(function() {
      socket.on('Myusername', function(username, Idnumber) {
        oldUsers.push(Idnumber);
        console.log('MyUsername : ' + username + " and ID :" + Idnumber);
      });
      socket.on('getUsers', function(SocketsList) {
        // console.log(SocketsList);
        var allUserIds = getDetails(SocketsList, "idNumber");
        // console.log(allUserIds);
        for (var i in SocketsList) {
          if (oldUsers.indexOf(SocketsList[i].idNumber) == -1) {
            oldUsers.push(SocketsList[i].idNumber);
            console.log(oldUsers);
            $('body').append('<div id="' + SocketsList[i].idNumber + '" class="client-cursor" style="top:' + SocketsList[i].mouseX + 'px;left:' + SocketsList[i].mouseY + 'px;"><img src="public/img/Cursor.png" width="25px" height="23px"><span class="tooltiptext">' + SocketsList[i].username + '</span></div>');
          }
        }
      });


      $(document).mousemove(function(event) {

        socket.emit('mouseMove', event.pageX, event.pageY);

      });



      socket.on('mouseMove', function(idNumber,eventx,eventy) {


        $('#'+idNumber).animate({
          'left': eventx + 'px',
          'top': eventy + 'px'
        }, 0);

      });

      function getDetails(SocketsList, key) {
        var ListOfUsers = [];
        for (var i = 0; i < SocketsList.length; ++i)

          ListOfUsers.push(SocketsList[i][key]);
        return ListOfUsers;
      }

    });
  </script>
</body>

</html>
